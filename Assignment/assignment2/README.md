# 2022. 09. 26. (Mon)
## First Trial
~~~
> # Model Fitting
> fit.all <- lm(발전량 ~., data=train_data)
> fit.step = step(fit.all, direction='both')
Start:  AIC=78066.89
발전량 ~ monthx + monthy + dayx + dayy + hourx + houry + 기온..C. + 
    강수량.mm. + 풍속.m__s. + 습도... + 증기압.hPa. + 현지기압.hPa. + 
    일조.hr. + 지면온도..C. + SO2 + CO + O3 + NO2 + PM10 + PM25

                Df Sum of Sq      RSS   AIC
- dayx           1        94 64676157 78065
- 풍속.m__s.     1      9837 64685899 78066
- 강수량.mm.     1     13418 64689481 78067
<none>                       64676063 78067
- dayy           1     34196 64710259 78070
- CO             1     46158 64722220 78071
- hourx          1    117207 64793269 78081
- monthx         1    135755 64811818 78083
- 현지기압.hPa.  1    148656 64824718 78085
- 증기압.hPa.    1    241856 64917919 78098
- PM10           1    381684 65057746 78116
- SO2            1    434949 65111012 78124
- O3             1    499206 65175269 78132
- monthy         1    688509 65364572 78158
- 습도...        1    808927 65484990 78174
- NO2            1   1485821 66161884 78264
- PM25           1   1875852 66551915 78315
- 기온..C.       1   2313985 66990048 78373
- 일조.hr.       1  12331467 77007530 79594
- houry          1  12347137 77023200 79595
- 지면온도..C.   1  15699220 80375282 79969

Step:  AIC=78064.9
발전량 ~ monthx + monthy + dayy + hourx + houry + 기온..C. + 
    강수량.mm. + 풍속.m__s. + 습도... + 증기압.hPa. + 현지기압.hPa. + 
    일조.hr. + 지면온도..C. + SO2 + CO + O3 + NO2 + PM10 + PM25

                Df Sum of Sq      RSS   AIC
- 풍속.m__s.     1      9865 64686022 78064
- 강수량.mm.     1     13376 64689533 78065
<none>                       64676157 78065
+ dayx           1        94 64676063 78067
- dayy           1     34154 64710311 78068
- CO             1     46115 64722271 78069
- hourx          1    117163 64793320 78079
- monthx         1    137367 64813523 78081
- 현지기압.hPa.  1    150314 64826471 78083
- 증기압.hPa.    1    242219 64918375 78096
- PM10           1    381732 65057889 78114
- SO2            1    435329 65111486 78122
- O3             1    499196 65175352 78130
- monthy         1    689474 65365631 78156
- 습도...        1    814547 65490703 78173
- NO2            1   1487079 66163236 78262
- PM25           1   1877029 66553186 78314
- 기온..C.       1   2331366 67007522 78373
- 일조.hr.       1  12331806 77007963 79592
- houry          1  12372117 77048273 79596
- 지면온도..C.   1  15725871 80402028 79969

Step:  AIC=78064.24
발전량 ~ monthx + monthy + dayy + hourx + houry + 기온..C. + 
    강수량.mm. + 습도... + 증기압.hPa. + 현지기압.hPa. + 일조.hr. + 
    지면온도..C. + SO2 + CO + O3 + NO2 + PM10 + PM25

                Df Sum of Sq      RSS   AIC
- 강수량.mm.     1     11253 64697274 78064
<none>                       64686022 78064
+ 풍속.m__s.     1      9865 64676157 78065
+ dayx           1       122 64685899 78066
- dayy           1     32578 64718600 78067
- CO             1     45804 64731825 78068
- hourx          1    111013 64797034 78077
- 현지기압.hPa.  1    141079 64827100 78081
- monthx         1    142998 64829020 78082
- 증기압.hPa.    1    234565 64920587 78094
- PM10           1    375879 65061901 78113
- SO2            1    432152 65118173 78121
- O3             1    491309 65177330 78129
- monthy         1    716938 65402960 78159
- 습도...        1    970513 65656535 78193
- NO2            1   1594434 66280456 78276
- PM25           1   1869164 66555185 78312
- 기온..C.       1   2353660 67039682 78375
- 일조.hr.       1  12362292 77048313 79594
- houry          1  12712432 77398453 79634
- 지면온도..C.   1  15737142 80423164 79970

Step:  AIC=78063.76
발전량 ~ monthx + monthy + dayy + hourx + houry + 기온..C. + 
    습도... + 증기압.hPa. + 현지기압.hPa. + 일조.hr. + 지면온도..C. + 
    SO2 + CO + O3 + NO2 + PM10 + PM25

                Df Sum of Sq      RSS   AIC
<none>                       64697274 78064
+ 강수량.mm.     1     11253 64686022 78064
+ 풍속.m__s.     1      7742 64689533 78065
+ dayx           1        75 64697200 78066
- dayy           1     30990 64728264 78066
- CO             1     45871 64743146 78068
- hourx          1    119560 64816834 78078
- monthx         1    140404 64837678 78081
- 현지기압.hPa.  1    145367 64842642 78081
- 증기압.hPa.    1    237801 64935076 78094
- PM10           1    369761 65067035 78112
- SO2            1    431250 65128525 78120
- O3             1    504593 65201868 78130
- monthy         1    714362 65411637 78158
- 습도...        1   1013806 65711081 78198
- NO2            1   1593814 66291089 78275
- PM25           1   1886620 66583895 78314
- 기온..C.       1   2354620 67051894 78375
- 일조.hr.       1  12398003 77095278 79598
- houry          1  12878820 77576094 79652
- 지면온도..C.   1  15868055 80565329 79983
> fit.step$anova
          Step Df    Deviance Resid. Df Resid. Dev      AIC
1              NA          NA      8739   64676063 78066.89
2       - dayx  1    93.88313      8740   64676157 78064.90
3 - 풍속.m__s.  1  9864.98280      8741   64686022 78064.24
4 - 강수량.mm.  1 11252.85614      8742   64697274 78063.76
> summary(fit.step)

Call:
lm(formula = 발전량 ~ monthx + monthy + dayy + hourx + houry + 
    기온..C. + 습도... + 증기압.hPa. + 현지기압.hPa. + 일조.hr. + 
    지면온도..C. + SO2 + CO + O3 + NO2 + PM10 + PM25, data = train_data)

Residuals:
    Min      1Q  Median      3Q     Max 
-614.05  -43.30    4.73   44.17  365.94 

Coefficients:
                Estimate Std. Error t value Pr(>|t|)    
(Intercept)   -9.166e+02  2.418e+02  -3.790 0.000152 ***
monthx         1.235e+01  2.836e+00   4.356 1.34e-05 ***
monthy         3.048e+01  3.102e+00   9.825  < 2e-16 ***
dayy           2.740e+00  1.339e+00   2.046 0.040756 *  
hourx          8.243e+00  2.051e+00   4.019 5.89e-05 ***
houry         -7.739e+01  1.855e+00 -41.716  < 2e-16 ***
기온..C.      -9.034e+00  5.065e-01 -17.837  < 2e-16 ***
습도...       -1.001e+00  8.553e-02 -11.704  < 2e-16 ***
증기압.hPa.   -2.330e+00  4.111e-01  -5.669 1.49e-08 ***
현지기압.hPa.  1.044e+00  2.354e-01   4.432 9.45e-06 ***
일조.hr.       1.568e+02  3.831e+00  40.930  < 2e-16 ***
지면온도..C.   1.316e+01  2.843e-01  46.305  < 2e-16 ***
SO2            3.164e+03  4.145e+02   7.634 2.52e-14 ***
CO            -2.221e+01  8.922e+00  -2.490 0.012806 *  
O3            -7.244e+02  8.773e+01  -8.257  < 2e-16 ***
NO2           -2.142e+03  1.460e+02 -14.675  < 2e-16 ***
PM10          -5.624e-01  7.957e-02  -7.068 1.69e-12 ***
PM25           2.638e+00  1.652e-01  15.966  < 2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 86.03 on 8742 degrees of freedom
Multiple R-squared:  0.8179,   Adjusted R-squared:  0.8175 
F-statistic:  2309 on 17 and 8742 DF,  p-value: < 2.2e-16
~~~
~~~
> cv.mse.test = mse.test/V
> cv.mae.test = mae.test/V
> cv.mse.test
[1] 7170.053
> sqrt(cv.mse.test)
[1] 84.67616
> cv.mae.test
[1] 61.62386
~~~
