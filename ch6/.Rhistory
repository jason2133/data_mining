library(MASS)
i = which(Boston$medv == 50)
library(MASS)
# 50th data: Outlier -> So Exclude this data
i = which(Boston$medv == 50)
boston = Boston[-i,] # delete cases with medv=50
boston$chas = factor(boston$chas)
boston$rad = factor(boston$rad)
# Factor: Qualitative 질적 변수로 적용하기 때문에 그렇다.
boston$chas = factor(boston$chas)
boston$rad = factor(boston$rad)
## Model fitting
fit.all = lm(medv ~ ., data = boston) # fit a linear model with all variables
fit.step = step(fit.all, direction="both") # stepwise variable selection
fit.step$anova
summary(fit.step) # print the fitted model
yhat = predict(fit.step, newdata=boston, type="response") # predictions
head(yhat)
plot(boston$medv, yhat, xlim=c(0,50), ylim=c(0,50), xlab="Observed Values", ylab="Fitted Values")
abline(a=0, b=1)
mean((boston$medv - yhat)^2)  # MSE
mean(abs(boston$medv - yhat)) # MAE
